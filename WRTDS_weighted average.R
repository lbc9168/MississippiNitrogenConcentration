setwd("C:/Users/Bingcai/OSU/AED Research/Mississipi/2015 Summer_All sites/WRTDS model")

## ILLI_VC
ILLI_VC = read.csv("ILLI_VC.csv")

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA02 != 0,], T_Tbar2^2)
ILLI_VC.lm.0to2 = with(ILLI_VC[ILLI_VC$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
ILLI_VC.lm.2.0to2 = with(ILLI_VC[ILLI_VC$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(ILLI_VC.lm.0to2)
summary(ILLI_VC.lm.2.0to2)


Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA13 != 0,], T_Tbar2^2)
ILLI_VC.lm.1to3 = with(ILLI_VC[ILLI_VC$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
ILLI_VC.lm.2.1to3 = with(ILLI_VC[ILLI_VC$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(ILLI_VC.lm.1to3)
summary(ILLI_VC.lm.2.1to3)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA24 != 0,], T_Tbar2^2)
ILLI_VC.lm.2to4 = with(ILLI_VC[ILLI_VC$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
ILLI_VC.lm.2.2to4 = with(ILLI_VC[ILLI_VC$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(ILLI_VC.lm.2to4)
summary(ILLI_VC.lm.2.2to4)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA35 != 0,], T_Tbar2^2)
ILLI_VC.lm.3to5 = with(ILLI_VC[ILLI_VC$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
ILLI_VC.lm.2.3to5 = with(ILLI_VC[ILLI_VC$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(ILLI_VC.lm.3to5)
summary(ILLI_VC.lm.2.3to5)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA46 != 0,], T_Tbar2^2)
ILLI_VC.lm.4to6 = with(ILLI_VC[ILLI_VC$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
ILLI_VC.lm.2.4to6 = with(ILLI_VC[ILLI_VC$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(ILLI_VC.lm.4to6)
summary(ILLI_VC.lm.2.4to6)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA57 != 0,], T_Tbar2^2)
ILLI_VC.lm.5to7 = with(ILLI_VC[ILLI_VC$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
ILLI_VC.lm.2.5to7 = with(ILLI_VC[ILLI_VC$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(ILLI_VC.lm.5to7)
summary(ILLI_VC.lm.2.5to7)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA68 != 0,], T_Tbar2^2)
ILLI_VC.lm.6to8 = with(ILLI_VC[ILLI_VC$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
ILLI_VC.lm.2.6to8 = with(ILLI_VC[ILLI_VC$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(ILLI_VC.lm.6to8)
summary(ILLI_VC.lm.2.6to8)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA79 != 0,], T_Tbar2^2)
ILLI_VC.lm.7to9 = with(ILLI_VC[ILLI_VC$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
ILLI_VC.lm.2.7to9 = with(ILLI_VC[ILLI_VC$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(ILLI_VC.lm.7to9)
summary(ILLI_VC.lm.2.7to9)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA810 != 0,], T_Tbar2^2)
ILLI_VC.lm.8to10 = with(ILLI_VC[ILLI_VC$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
ILLI_VC.lm.2.8to10 = with(ILLI_VC[ILLI_VC$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(ILLI_VC.lm.8to10)
summary(ILLI_VC.lm.2.8to10)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA911 != 0,], T_Tbar2^2)
ILLI_VC.lm.9to11 = with(ILLI_VC[ILLI_VC$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
ILLI_VC.lm.2.9to11 = with(ILLI_VC[ILLI_VC$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(ILLI_VC.lm.9to11)
summary(ILLI_VC.lm.2.9to11)

Q_Qbar2sq = with(ILLI_VC[ILLI_VC$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(ILLI_VC[ILLI_VC$NPA1012 != 0,], T_Tbar2^2)
ILLI_VC.lm.10to12 = with(ILLI_VC[ILLI_VC$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
ILLI_VC.lm.2.10to12 = with(ILLI_VC[ILLI_VC$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(ILLI_VC.lm.10to12)
summary(ILLI_VC.lm.2.10to12)


## IOWA_WAP
IOWA_WAP = read.csv("IOWA_WAP.csv")

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA02 != 0,], T_Tbar2^2)
IOWA_WAP.lm.0to2 = with(IOWA_WAP[IOWA_WAP$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
IOWA_WAP.lm.2.0to2 = with(IOWA_WAP[IOWA_WAP$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(IOWA_WAP.lm.0to2)
summary(IOWA_WAP.lm.2.0to2)


Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA13 != 0,], T_Tbar2^2)
IOWA_WAP.lm.1to3 = with(IOWA_WAP[IOWA_WAP$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
IOWA_WAP.lm.2.1to3 = with(IOWA_WAP[IOWA_WAP$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(IOWA_WAP.lm.1to3)
summary(IOWA_WAP.lm.2.1to3)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA24 != 0,], T_Tbar2^2)
IOWA_WAP.lm.2to4 = with(IOWA_WAP[IOWA_WAP$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
IOWA_WAP.lm.2.2to4 = with(IOWA_WAP[IOWA_WAP$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(IOWA_WAP.lm.2to4)
summary(IOWA_WAP.lm.2.2to4)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA35 != 0,], T_Tbar2^2)
IOWA_WAP.lm.3to5 = with(IOWA_WAP[IOWA_WAP$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
IOWA_WAP.lm.2.3to5 = with(IOWA_WAP[IOWA_WAP$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(IOWA_WAP.lm.3to5)
summary(IOWA_WAP.lm.2.3to5)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA46 != 0,], T_Tbar2^2)
IOWA_WAP.lm.4to6 = with(IOWA_WAP[IOWA_WAP$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
IOWA_WAP.lm.2.4to6 = with(IOWA_WAP[IOWA_WAP$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(IOWA_WAP.lm.4to6)
summary(IOWA_WAP.lm.2.4to6)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA57 != 0,], T_Tbar2^2)
IOWA_WAP.lm.5to7 = with(IOWA_WAP[IOWA_WAP$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
IOWA_WAP.lm.2.5to7 = with(IOWA_WAP[IOWA_WAP$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(IOWA_WAP.lm.5to7)
summary(IOWA_WAP.lm.2.5to7)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA68 != 0,], T_Tbar2^2)
IOWA_WAP.lm.6to8 = with(IOWA_WAP[IOWA_WAP$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
IOWA_WAP.lm.2.6to8 = with(IOWA_WAP[IOWA_WAP$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(IOWA_WAP.lm.6to8)
summary(IOWA_WAP.lm.2.6to8)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA79 != 0,], T_Tbar2^2)
IOWA_WAP.lm.7to9 = with(IOWA_WAP[IOWA_WAP$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
IOWA_WAP.lm.2.7to9 = with(IOWA_WAP[IOWA_WAP$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(IOWA_WAP.lm.7to9)
summary(IOWA_WAP.lm.2.7to9)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA810 != 0,], T_Tbar2^2)
IOWA_WAP.lm.8to10 = with(IOWA_WAP[IOWA_WAP$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
IOWA_WAP.lm.2.8to10 = with(IOWA_WAP[IOWA_WAP$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(IOWA_WAP.lm.8to10)
summary(IOWA_WAP.lm.2.8to10)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA911 != 0,], T_Tbar2^2)
IOWA_WAP.lm.9to11 = with(IOWA_WAP[IOWA_WAP$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
IOWA_WAP.lm.2.9to11 = with(IOWA_WAP[IOWA_WAP$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(IOWA_WAP.lm.9to11)
summary(IOWA_WAP.lm.2.9to11)

Q_Qbar2sq = with(IOWA_WAP[IOWA_WAP$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(IOWA_WAP[IOWA_WAP$NPA1012 != 0,], T_Tbar2^2)
IOWA_WAP.lm.10to12 = with(IOWA_WAP[IOWA_WAP$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
IOWA_WAP.lm.2.10to12 = with(IOWA_WAP[IOWA_WAP$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(IOWA_WAP.lm.10to12)
summary(IOWA_WAP.lm.2.10to12)


## MIZZ_HE
MIZZ_HE = read.csv("MIZZ_HE.csv")

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,], T_Tbar2^2)
<<<<<<< HEAD
lnNPA24sq = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,], log(NPA02)^2)
MIZZ_HE.lm.0to2 = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)+lnNPA24sq))
MIZZ_HE.lm.2.0to2 = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)+lnNPA24sq))
=======
MIZZ_HE.lm.0to2 = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
MIZZ_HE.lm.2.0to2 = with(MIZZ_HE[MIZZ_HE$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
>>>>>>> parent of e109f3e... Revert "WRTDS weighted average"
summary(MIZZ_HE.lm.0to2)
summary(MIZZ_HE.lm.2.0to2)


Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA13 != 0,], T_Tbar2^2)
MIZZ_HE.lm.1to3 = with(MIZZ_HE[MIZZ_HE$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
MIZZ_HE.lm.2.1to3 = with(MIZZ_HE[MIZZ_HE$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(MIZZ_HE.lm.1to3)
summary(MIZZ_HE.lm.2.1to3)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA24 != 0,], T_Tbar2^2)
MIZZ_HE.lm.2to4 = with(MIZZ_HE[MIZZ_HE$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
MIZZ_HE.lm.2.2to4 = with(MIZZ_HE[MIZZ_HE$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(MIZZ_HE.lm.2to4)
summary(MIZZ_HE.lm.2.2to4)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA35 != 0,], T_Tbar2^2)
MIZZ_HE.lm.3to5 = with(MIZZ_HE[MIZZ_HE$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
MIZZ_HE.lm.2.3to5 = with(MIZZ_HE[MIZZ_HE$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(MIZZ_HE.lm.3to5)
summary(MIZZ_HE.lm.2.3to5)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA46 != 0,], T_Tbar2^2)
MIZZ_HE.lm.4to6 = with(MIZZ_HE[MIZZ_HE$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
MIZZ_HE.lm.2.4to6 = with(MIZZ_HE[MIZZ_HE$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(MIZZ_HE.lm.4to6)
summary(MIZZ_HE.lm.2.4to6)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA57 != 0,], T_Tbar2^2)
MIZZ_HE.lm.5to7 = with(MIZZ_HE[MIZZ_HE$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
MIZZ_HE.lm.2.5to7 = with(MIZZ_HE[MIZZ_HE$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(MIZZ_HE.lm.5to7)
summary(MIZZ_HE.lm.2.5to7)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA68 != 0,], T_Tbar2^2)
MIZZ_HE.lm.6to8 = with(MIZZ_HE[MIZZ_HE$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
MIZZ_HE.lm.2.6to8 = with(MIZZ_HE[MIZZ_HE$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(MIZZ_HE.lm.6to8)
summary(MIZZ_HE.lm.2.6to8)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA79 != 0,], T_Tbar2^2)
MIZZ_HE.lm.7to9 = with(MIZZ_HE[MIZZ_HE$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
MIZZ_HE.lm.2.7to9 = with(MIZZ_HE[MIZZ_HE$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(MIZZ_HE.lm.7to9)
summary(MIZZ_HE.lm.2.7to9)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA810 != 0,], T_Tbar2^2)
MIZZ_HE.lm.8to10 = with(MIZZ_HE[MIZZ_HE$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
MIZZ_HE.lm.2.8to10 = with(MIZZ_HE[MIZZ_HE$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(MIZZ_HE.lm.8to10)
summary(MIZZ_HE.lm.2.8to10)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA911 != 0,], T_Tbar2^2)
MIZZ_HE.lm.9to11 = with(MIZZ_HE[MIZZ_HE$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
MIZZ_HE.lm.2.9to11 = with(MIZZ_HE[MIZZ_HE$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(MIZZ_HE.lm.9to11)
summary(MIZZ_HE.lm.2.9to11)

Q_Qbar2sq = with(MIZZ_HE[MIZZ_HE$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MIZZ_HE[MIZZ_HE$NPA1012 != 0,], T_Tbar2^2)
MIZZ_HE.lm.10to12 = with(MIZZ_HE[MIZZ_HE$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
MIZZ_HE.lm.2.10to12 = with(MIZZ_HE[MIZZ_HE$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(MIZZ_HE.lm.10to12)
summary(MIZZ_HE.lm.2.10to12)



## MSSP_CL
MSSP_CL = read.csv("MSSP_CL.csv")

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA02 != 0,], T_Tbar2^2)
MSSP_CL.lm.0to2 = with(MSSP_CL[MSSP_CL$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
MSSP_CL.lm.2.0to2 = with(MSSP_CL[MSSP_CL$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(MSSP_CL.lm.0to2)
summary(MSSP_CL.lm.2.0to2)


Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA13 != 0,], T_Tbar2^2)
MSSP_CL.lm.1to3 = with(MSSP_CL[MSSP_CL$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
MSSP_CL.lm.2.1to3 = with(MSSP_CL[MSSP_CL$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(MSSP_CL.lm.1to3)
summary(MSSP_CL.lm.2.1to3)

<<<<<<< HEAD
## test square adjustment
Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA24 != 0,], T_Tbar2^2)
lnNPA24sq = with(MSSP_CL[MSSP_CL$NPA24 != 0,], log(NPA24)^2)
MSSP_CL.lm.2to4 = with(MSSP_CL[MSSP_CL$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)+lnNPA24sq))
MSSP_CL.lm.2.2to4 = with(MSSP_CL[MSSP_CL$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)+lnNPA24sq))
=======
Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA24 != 0,], T_Tbar2^2)
MSSP_CL.lm.2to4 = with(MSSP_CL[MSSP_CL$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
MSSP_CL.lm.2.2to4 = with(MSSP_CL[MSSP_CL$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
>>>>>>> parent of e109f3e... Revert "WRTDS weighted average"
summary(MSSP_CL.lm.2to4)
summary(MSSP_CL.lm.2.2to4)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA35 != 0,], T_Tbar2^2)
MSSP_CL.lm.3to5 = with(MSSP_CL[MSSP_CL$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
MSSP_CL.lm.2.3to5 = with(MSSP_CL[MSSP_CL$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(MSSP_CL.lm.3to5)
summary(MSSP_CL.lm.2.3to5)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA46 != 0,], T_Tbar2^2)
MSSP_CL.lm.4to6 = with(MSSP_CL[MSSP_CL$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
MSSP_CL.lm.2.4to6 = with(MSSP_CL[MSSP_CL$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(MSSP_CL.lm.4to6)
summary(MSSP_CL.lm.2.4to6)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA57 != 0,], T_Tbar2^2)
MSSP_CL.lm.5to7 = with(MSSP_CL[MSSP_CL$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
MSSP_CL.lm.2.5to7 = with(MSSP_CL[MSSP_CL$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(MSSP_CL.lm.5to7)
summary(MSSP_CL.lm.2.5to7)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA68 != 0,], T_Tbar2^2)
MSSP_CL.lm.6to8 = with(MSSP_CL[MSSP_CL$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
MSSP_CL.lm.2.6to8 = with(MSSP_CL[MSSP_CL$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(MSSP_CL.lm.6to8)
summary(MSSP_CL.lm.2.6to8)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA79 != 0,], T_Tbar2^2)
MSSP_CL.lm.7to9 = with(MSSP_CL[MSSP_CL$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
MSSP_CL.lm.2.7to9 = with(MSSP_CL[MSSP_CL$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(MSSP_CL.lm.7to9)
summary(MSSP_CL.lm.2.7to9)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA810 != 0,], T_Tbar2^2)
MSSP_CL.lm.8to10 = with(MSSP_CL[MSSP_CL$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
MSSP_CL.lm.2.8to10 = with(MSSP_CL[MSSP_CL$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(MSSP_CL.lm.8to10)
summary(MSSP_CL.lm.2.8to10)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA911 != 0,], T_Tbar2^2)
MSSP_CL.lm.9to11 = with(MSSP_CL[MSSP_CL$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
MSSP_CL.lm.2.9to11 = with(MSSP_CL[MSSP_CL$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(MSSP_CL.lm.9to11)
summary(MSSP_CL.lm.2.9to11)

Q_Qbar2sq = with(MSSP_CL[MSSP_CL$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_CL[MSSP_CL$NPA1012 != 0,], T_Tbar2^2)
MSSP_CL.lm.10to12 = with(MSSP_CL[MSSP_CL$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
MSSP_CL.lm.2.10to12 = with(MSSP_CL[MSSP_CL$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(MSSP_CL.lm.10to12)
summary(MSSP_CL.lm.2.10to12)



## MSSP_GR
MSSP_GR = read.csv("MSSP_GR.csv")

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA02 != 0,], T_Tbar2^2)
MSSP_GR.lm.0to2 = with(MSSP_GR[MSSP_GR$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
MSSP_GR.lm.2.0to2 = with(MSSP_GR[MSSP_GR$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(MSSP_GR.lm.0to2)
summary(MSSP_GR.lm.2.0to2)


Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA13 != 0,], T_Tbar2^2)
MSSP_GR.lm.1to3 = with(MSSP_GR[MSSP_GR$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
MSSP_GR.lm.2.1to3 = with(MSSP_GR[MSSP_GR$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(MSSP_GR.lm.1to3)
summary(MSSP_GR.lm.2.1to3)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA24 != 0,], T_Tbar2^2)
MSSP_GR.lm.2to4 = with(MSSP_GR[MSSP_GR$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
MSSP_GR.lm.2.2to4 = with(MSSP_GR[MSSP_GR$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(MSSP_GR.lm.2to4)
summary(MSSP_GR.lm.2.2to4)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA35 != 0,], T_Tbar2^2)
MSSP_GR.lm.3to5 = with(MSSP_GR[MSSP_GR$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
MSSP_GR.lm.2.3to5 = with(MSSP_GR[MSSP_GR$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(MSSP_GR.lm.3to5)
summary(MSSP_GR.lm.2.3to5)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA46 != 0,], T_Tbar2^2)
MSSP_GR.lm.4to6 = with(MSSP_GR[MSSP_GR$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
MSSP_GR.lm.2.4to6 = with(MSSP_GR[MSSP_GR$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(MSSP_GR.lm.4to6)
summary(MSSP_GR.lm.2.4to6)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA57 != 0,], T_Tbar2^2)
MSSP_GR.lm.5to7 = with(MSSP_GR[MSSP_GR$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
MSSP_GR.lm.2.5to7 = with(MSSP_GR[MSSP_GR$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(MSSP_GR.lm.5to7)
summary(MSSP_GR.lm.2.5to7)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA68 != 0,], T_Tbar2^2)
MSSP_GR.lm.6to8 = with(MSSP_GR[MSSP_GR$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
MSSP_GR.lm.2.6to8 = with(MSSP_GR[MSSP_GR$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(MSSP_GR.lm.6to8)
summary(MSSP_GR.lm.2.6to8)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA79 != 0,], T_Tbar2^2)
MSSP_GR.lm.7to9 = with(MSSP_GR[MSSP_GR$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
MSSP_GR.lm.2.7to9 = with(MSSP_GR[MSSP_GR$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(MSSP_GR.lm.7to9)
summary(MSSP_GR.lm.2.7to9)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA810 != 0,], T_Tbar2^2)
MSSP_GR.lm.8to10 = with(MSSP_GR[MSSP_GR$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
MSSP_GR.lm.2.8to10 = with(MSSP_GR[MSSP_GR$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(MSSP_GR.lm.8to10)
summary(MSSP_GR.lm.2.8to10)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA911 != 0,], T_Tbar2^2)
MSSP_GR.lm.9to11 = with(MSSP_GR[MSSP_GR$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
MSSP_GR.lm.2.9to11 = with(MSSP_GR[MSSP_GR$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(MSSP_GR.lm.9to11)
summary(MSSP_GR.lm.2.9to11)

Q_Qbar2sq = with(MSSP_GR[MSSP_GR$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_GR[MSSP_GR$NPA1012 != 0,], T_Tbar2^2)
MSSP_GR.lm.10to12 = with(MSSP_GR[MSSP_GR$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
MSSP_GR.lm.2.10to12 = with(MSSP_GR[MSSP_GR$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(MSSP_GR.lm.10to12)
summary(MSSP_GR.lm.2.10to12)



## MSSP_OUT
MSSP_OUT = read.csv("MSSP_OUT.csv")

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA02 != 0,], T_Tbar2^2)
MSSP_OUT.lm.0to2 = with(MSSP_OUT[MSSP_OUT$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
MSSP_OUT.lm.2.0to2 = with(MSSP_OUT[MSSP_OUT$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(MSSP_OUT.lm.0to2)
summary(MSSP_OUT.lm.2.0to2)


Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA13 != 0,], T_Tbar2^2)
MSSP_OUT.lm.1to3 = with(MSSP_OUT[MSSP_OUT$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
MSSP_OUT.lm.2.1to3 = with(MSSP_OUT[MSSP_OUT$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(MSSP_OUT.lm.1to3)
summary(MSSP_OUT.lm.2.1to3)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA24 != 0,], T_Tbar2^2)
MSSP_OUT.lm.2to4 = with(MSSP_OUT[MSSP_OUT$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
MSSP_OUT.lm.2.2to4 = with(MSSP_OUT[MSSP_OUT$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(MSSP_OUT.lm.2to4)
summary(MSSP_OUT.lm.2.2to4)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA35 != 0,], T_Tbar2^2)
MSSP_OUT.lm.3to5 = with(MSSP_OUT[MSSP_OUT$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
MSSP_OUT.lm.2.3to5 = with(MSSP_OUT[MSSP_OUT$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(MSSP_OUT.lm.3to5)
summary(MSSP_OUT.lm.2.3to5)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA46 != 0,], T_Tbar2^2)
MSSP_OUT.lm.4to6 = with(MSSP_OUT[MSSP_OUT$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
MSSP_OUT.lm.2.4to6 = with(MSSP_OUT[MSSP_OUT$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(MSSP_OUT.lm.4to6)
summary(MSSP_OUT.lm.2.4to6)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA57 != 0,], T_Tbar2^2)
MSSP_OUT.lm.5to7 = with(MSSP_OUT[MSSP_OUT$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
MSSP_OUT.lm.2.5to7 = with(MSSP_OUT[MSSP_OUT$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(MSSP_OUT.lm.5to7)
summary(MSSP_OUT.lm.2.5to7)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA68 != 0,], T_Tbar2^2)
MSSP_OUT.lm.6to8 = with(MSSP_OUT[MSSP_OUT$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
MSSP_OUT.lm.2.6to8 = with(MSSP_OUT[MSSP_OUT$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(MSSP_OUT.lm.6to8)
summary(MSSP_OUT.lm.2.6to8)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA79 != 0,], T_Tbar2^2)
MSSP_OUT.lm.7to9 = with(MSSP_OUT[MSSP_OUT$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
MSSP_OUT.lm.2.7to9 = with(MSSP_OUT[MSSP_OUT$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(MSSP_OUT.lm.7to9)
summary(MSSP_OUT.lm.2.7to9)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA810 != 0,], T_Tbar2^2)
MSSP_OUT.lm.8to10 = with(MSSP_OUT[MSSP_OUT$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
MSSP_OUT.lm.2.8to10 = with(MSSP_OUT[MSSP_OUT$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(MSSP_OUT.lm.8to10)
summary(MSSP_OUT.lm.2.8to10)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA911 != 0,], T_Tbar2^2)
MSSP_OUT.lm.9to11 = with(MSSP_OUT[MSSP_OUT$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
MSSP_OUT.lm.2.9to11 = with(MSSP_OUT[MSSP_OUT$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(MSSP_OUT.lm.9to11)
summary(MSSP_OUT.lm.2.9to11)

Q_Qbar2sq = with(MSSP_OUT[MSSP_OUT$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_OUT[MSSP_OUT$NPA1012 != 0,], T_Tbar2^2)
MSSP_OUT.lm.10to12 = with(MSSP_OUT[MSSP_OUT$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
MSSP_OUT.lm.2.10to12 = with(MSSP_OUT[MSSP_OUT$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(MSSP_OUT.lm.10to12)
summary(MSSP_OUT.lm.2.10to12)



## MSSP_TH
MSSP_TH = read.csv("MSSP_TH.csv")

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA02 != 0,], T_Tbar2^2)
MSSP_TH.lm.0to2 = with(MSSP_TH[MSSP_TH$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
MSSP_TH.lm.2.0to2 = with(MSSP_TH[MSSP_TH$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(MSSP_TH.lm.0to2)
summary(MSSP_TH.lm.2.0to2)


Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA13 != 0,], T_Tbar2^2)
MSSP_TH.lm.1to3 = with(MSSP_TH[MSSP_TH$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
MSSP_TH.lm.2.1to3 = with(MSSP_TH[MSSP_TH$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(MSSP_TH.lm.1to3)
summary(MSSP_TH.lm.2.1to3)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA24 != 0,], T_Tbar2^2)
MSSP_TH.lm.2to4 = with(MSSP_TH[MSSP_TH$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
MSSP_TH.lm.2.2to4 = with(MSSP_TH[MSSP_TH$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(MSSP_TH.lm.2to4)
summary(MSSP_TH.lm.2.2to4)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA35 != 0,], T_Tbar2^2)
MSSP_TH.lm.3to5 = with(MSSP_TH[MSSP_TH$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
MSSP_TH.lm.2.3to5 = with(MSSP_TH[MSSP_TH$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(MSSP_TH.lm.3to5)
summary(MSSP_TH.lm.2.3to5)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA46 != 0,], T_Tbar2^2)
MSSP_TH.lm.4to6 = with(MSSP_TH[MSSP_TH$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
MSSP_TH.lm.2.4to6 = with(MSSP_TH[MSSP_TH$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(MSSP_TH.lm.4to6)
summary(MSSP_TH.lm.2.4to6)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA57 != 0,], T_Tbar2^2)
MSSP_TH.lm.5to7 = with(MSSP_TH[MSSP_TH$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
MSSP_TH.lm.2.5to7 = with(MSSP_TH[MSSP_TH$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(MSSP_TH.lm.5to7)
summary(MSSP_TH.lm.2.5to7)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA68 != 0,], T_Tbar2^2)
MSSP_TH.lm.6to8 = with(MSSP_TH[MSSP_TH$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
MSSP_TH.lm.2.6to8 = with(MSSP_TH[MSSP_TH$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(MSSP_TH.lm.6to8)
summary(MSSP_TH.lm.2.6to8)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA79 != 0,], T_Tbar2^2)
MSSP_TH.lm.7to9 = with(MSSP_TH[MSSP_TH$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
MSSP_TH.lm.2.7to9 = with(MSSP_TH[MSSP_TH$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(MSSP_TH.lm.7to9)
summary(MSSP_TH.lm.2.7to9)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA810 != 0,], T_Tbar2^2)
MSSP_TH.lm.8to10 = with(MSSP_TH[MSSP_TH$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
MSSP_TH.lm.2.8to10 = with(MSSP_TH[MSSP_TH$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(MSSP_TH.lm.8to10)
summary(MSSP_TH.lm.2.8to10)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA911 != 0,], T_Tbar2^2)
MSSP_TH.lm.9to11 = with(MSSP_TH[MSSP_TH$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
MSSP_TH.lm.2.9to11 = with(MSSP_TH[MSSP_TH$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(MSSP_TH.lm.9to11)
summary(MSSP_TH.lm.2.9to11)

Q_Qbar2sq = with(MSSP_TH[MSSP_TH$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(MSSP_TH[MSSP_TH$NPA1012 != 0,], T_Tbar2^2)
MSSP_TH.lm.10to12 = with(MSSP_TH[MSSP_TH$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
MSSP_TH.lm.2.10to12 = with(MSSP_TH[MSSP_TH$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(MSSP_TH.lm.10to12)
summary(MSSP_TH.lm.2.10to12)



## OHIO_GRCH
OHIO_GRCH = read.csv("OHIO_GRCH.csv")

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA02 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA02 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.0to2 = with(OHIO_GRCH[OHIO_GRCH$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
OHIO_GRCH.lm.2.0to2 = with(OHIO_GRCH[OHIO_GRCH$NPA02 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA02)+log(CSRA02)))
summary(OHIO_GRCH.lm.0to2)
summary(OHIO_GRCH.lm.2.0to2)


Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA13 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA13 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.1to3 = with(OHIO_GRCH[OHIO_GRCH$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
OHIO_GRCH.lm.2.1to3 = with(OHIO_GRCH[OHIO_GRCH$NPA13 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA13)+log(CSRA13)))
summary(OHIO_GRCH.lm.1to3)
summary(OHIO_GRCH.lm.2.1to3)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA24 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA24 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.2to4 = with(OHIO_GRCH[OHIO_GRCH$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
OHIO_GRCH.lm.2.2to4 = with(OHIO_GRCH[OHIO_GRCH$NPA24 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA24)+log(CSRA24)))
summary(OHIO_GRCH.lm.2to4)
summary(OHIO_GRCH.lm.2.2to4)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA35 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA35 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.3to5 = with(OHIO_GRCH[OHIO_GRCH$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
OHIO_GRCH.lm.2.3to5 = with(OHIO_GRCH[OHIO_GRCH$NPA35 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA35)+log(CSRA35)))
summary(OHIO_GRCH.lm.3to5)
summary(OHIO_GRCH.lm.2.3to5)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA46 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA46 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.4to6 = with(OHIO_GRCH[OHIO_GRCH$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
OHIO_GRCH.lm.2.4to6 = with(OHIO_GRCH[OHIO_GRCH$NPA46 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA46)+log(CSRA46)))
summary(OHIO_GRCH.lm.4to6)
summary(OHIO_GRCH.lm.2.4to6)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA57 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA57 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.5to7 = with(OHIO_GRCH[OHIO_GRCH$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
OHIO_GRCH.lm.2.5to7 = with(OHIO_GRCH[OHIO_GRCH$NPA57 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA57)+log(CSRA57)))
summary(OHIO_GRCH.lm.5to7)
summary(OHIO_GRCH.lm.2.5to7)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA68 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA68 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.6to8 = with(OHIO_GRCH[OHIO_GRCH$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
OHIO_GRCH.lm.2.6to8 = with(OHIO_GRCH[OHIO_GRCH$NPA68 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA68)+log(CSRA68)))
summary(OHIO_GRCH.lm.6to8)
summary(OHIO_GRCH.lm.2.6to8)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA79 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA79 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.7to9 = with(OHIO_GRCH[OHIO_GRCH$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
OHIO_GRCH.lm.2.7to9 = with(OHIO_GRCH[OHIO_GRCH$NPA79 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA79)+log(CSRA79)))
summary(OHIO_GRCH.lm.7to9)
summary(OHIO_GRCH.lm.2.7to9)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA810 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA810 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.8to10 = with(OHIO_GRCH[OHIO_GRCH$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
OHIO_GRCH.lm.2.8to10 = with(OHIO_GRCH[OHIO_GRCH$NPA810 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA810)+log(CSRA810)))
summary(OHIO_GRCH.lm.8to10)
summary(OHIO_GRCH.lm.2.8to10)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA911 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA911 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.9to11 = with(OHIO_GRCH[OHIO_GRCH$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
OHIO_GRCH.lm.2.9to11 = with(OHIO_GRCH[OHIO_GRCH$NPA911 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA911)+log(CSRA911)))
summary(OHIO_GRCH.lm.9to11)
summary(OHIO_GRCH.lm.2.9to11)

Q_Qbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA1012 != 0,], log(Q_Qbar2)^2)
T_Tbar2sq = with(OHIO_GRCH[OHIO_GRCH$NPA1012 != 0,], T_Tbar2^2)
OHIO_GRCH.lm.10to12 = with(OHIO_GRCH[OHIO_GRCH$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
OHIO_GRCH.lm.2.10to12 = with(OHIO_GRCH[OHIO_GRCH$NPA1012 != 0,],lm(log(Conc)~log(Q_Qbar2)+Q_Qbar2sq+T_Tbar2+T_Tbar2sq+sin(2*pi*T)+cos(2*pi*T)+log(NPA1012)+log(CSRA1012)))
summary(OHIO_GRCH.lm.10to12)
summary(OHIO_GRCH.lm.2.10to12)
